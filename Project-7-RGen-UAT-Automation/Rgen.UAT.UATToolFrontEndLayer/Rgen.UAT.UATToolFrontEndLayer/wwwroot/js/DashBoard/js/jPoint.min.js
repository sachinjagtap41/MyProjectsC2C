(function(){var n=this,e,o=n.jPoint,f=n.jP,b=n.jPoint=n.jP=function(){return new b.fn.init()},d="FieldInternalName",a="FieldName",q="FieldType",p=null;b.Jpoint="0.8";b.getScript=(function(t,v,w){try{$.ajaxSetup({async:!v});$.getScript(t,w);$.ajaxSetup({async:true});return true}catch(u){return false}});b.valSiteURL=(function(u){var t="";if(u!=e){b.SiteURL=u;t=u}else{if(b.SiteURL!="undefined"&&b.SiteURL!=null){t=b.SiteURL}else{if(typeof L_Menu_BaseUrl!="undefined"&&L_Menu_BaseUrl!=null){t=L_Menu_BaseUrl;b.SiteURL=unescape(t)}}}return t});b.valListName=(function(u){var t="";var v=location.href.substr(0,location.href.indexOf("/Lists"));if(u!=e){b.ListName=u;t=u}else{if(b.ListName!="undefined"&&b.ListName!=null){t=b.ListName}else{if($.trim($("title").html().replace(/\n/g,"")).length>0){t=$.trim($.trim($("title").html().replace(/\n/g,"")).split("-")[0]);b.ListName=t}else{if(location.href.indexOf("/Lists/")>0){t=location.href.substr(v.length+7,location.href.substr((v.length+7)).indexOf("/"));b.ListName=unescape(t)}}}}return t});b.strip=(function(v){var t=v;try{if(v){t=t.replace(/_x[0-9A-Fa-f]{4}_/g,"");t=t.replace(/[^a-zA-Z0-9]/g,"")}}catch(u){}return t});b.sameNames=(function(w,v){var t=false;try{if(w==v){t=true}else{if(this.strip(w)==this.strip(v)){t=true}}}catch(u){}return t});b.fn=b.prototype={init:function(){p=this;return this}};b.fn.init.prototype=b.fn;b.fn.Lists=b.prototype.Lists=b.Lists=function(){this.Lists.Items=new Array();this.Lists.FieldCount=0;this.Lists.getList=this.Lists.setSPObject=(function(x,A){if(x.split("/").length<=1){A=x;x=b.valSiteURL()}var z=A.toUpperCase();var v=p.Lists[z]=new Object();if(x.length!=x.replace(/\/_vti_bin/i,"").length){x=x+"/"}else{if(x.substring(x.length-1)=="/"){x=x+"_vti_bin/"}else{x=x+"/_vti_bin/"}}v.SiteURL=x;v.ListName=A;v.CamlQuery="";v.extend=jQuery.extend;v.extend({getSchema:function(){try{var F=this;m(F.SiteURL+"lists.asmx","http://schemas.microsoft.com/sharepoint/soap/GetListContentTypes",'<GetListContentTypes xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+F.ListName+"</listName><contentTypeId></contentTypeId></GetListContentTypes>",function(G){var H=$(G).find("ContentType").eq(0).attr("ID");m(F.SiteURL+"lists.asmx","http://schemas.microsoft.com/sharepoint/soap/GetListContentType",'<GetListContentType xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+F.ListName+"</listName><contentTypeId>"+H+"</contentTypeId></GetListContentType>",function(J){b.Lists.ListName=F.ListName.toUpperCase();F.xmlDoc=J;var I=$(J).find("Field");F.Schema=new Array();$.each(I,function(L,K){var M={};M.FieldName=$(K).attr("DisplayName");M.FieldInternalName=$(K).attr("StaticName");M.FieldType=$(K).attr("Type");M.FieldDescription=$(K).attr("Description");M.FieldRequired=$(K).attr("Required")=="TRUE"||false;M.FieldDefault=$(K).children().length>0?$(K).children("Default").text():"";M.FieldXML=K;F.Schema.push(M)})})})}catch(E){}return F},getSPListFields:function(){return this.getSchema()},getSPItemByID:function(E){try{var G=null;this.CamlQuery="<Where><Eq><FieldRef Name='ID' /><Value Type='Counter'>"+E+"</Value></Eq></Where>";y(this);if(this.Items&&this.Items.length>0){G=this.Items[0]}return G}catch(F){alert("getSPItem Error:"+F.description)}},getSPItem:function(E){return this.getSPItemByID(E)},getSPItemsWithQuery:function(E,G){try{this.CamlQuery=E;w(this,G);return this}catch(F){alert("getSPItemsWithQuery Error:"+F.description)}},updateItem:function(H){var E={success:false,errorCode:"",errorText:"internal error",id:-1};try{var I=this;var G=c(I.ListName,H);m(I.SiteURL+"lists.asmx","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems",G,function(J){B(I,J);if($("ErrorText",J).length>0){E.success=false;E.errorCode=$("ErrorCode",J).text();E.errorText=$("ErrorText",J).text();E.id=E.ID=-1}else{E.success=true;E.errorCode="0x00000000";E.errorText=null;E.id=E.ID=$("z\\:row",J).attr("ows_ID")}})}catch(F){alert("updateItem Error:"+F)}return E},addItem:function(E){return this.updateItem(E)},deleteItem:function(I){var E={success:false,errorCode:"",errorText:"internal error"};try{var H=this;var G=k(H.ListName,I);m(H.SiteURL+"lists.asmx","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems",G,function(J){if($("ErrorText",J).length>0){E.success=false;E.errorCode=$("ErrorCode",J).text();E.errorText=$("ErrorText",J).text()}else{E.success=true;E.errorCode="0x00000000";E.errorText=null}})}catch(F){}return E},getSPViewCollection:function(){try{var F='<GetViewCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+this.ListName+"</listName></GetViewCollection>";var G=this;m(this.SiteURL+"views.asmx","http://schemas.microsoft.com/sharepoint/soap/GetViewCollection",F,function(H){G.xmlDoc=H;var I=$("View",H);if(I.length>0){u(G,I)}});return G}catch(E){alert("getSPViewCollection Error:"+E.description)}},getSPView:function(F){try{if(F==null){F=""}this.ViewName=F;C(this);return this}catch(E){alert("getSPView Error:"+E.description)}},getPictures:function(F){try{if(F==null){F=""}this.ViewName=F;C(this);return this}catch(E){alert("getPictures Error:"+E.description)}},filterItems:function(E,H){try{H=H.toUpperCase();var F=$.grep(this.Items,function(J,I){if(typeof J[E]!="undefined"){return J[E].toUpperCase().indexOf(H)>=0}});return F}catch(G){alert("filterItems Error:"+G.description)}},getItemsFieldData:function(G){try{var E=[];$.each(this.Items,function(){var H=this;var I={};$.each(G,function(){var J=this;I[J]=H[J]});E.push(I)});return E}catch(F){alert("getItemsFieldData Error:"+F.description)}}});return v;function y(G){try{G.Items=null;var F=r(G.ListName,G.CamlQuery,G.ViewFields||"",1,G.pagingInfo);m(G.SiteURL+"lists.asmx","http://schemas.microsoft.com/sharepoint/soap/GetListItems",F,function(H){B(G,H)})}catch(E){alert("getSPItemData Error:"+E.description)}}function w(H,G){try{var F=r(H.ListName,H.CamlQuery,H.ViewFields,G,H.pagingInfo);m(H.SiteURL+"lists.asmx","http://schemas.microsoft.com/sharepoint/soap/GetListItems",F,function(I){B(H,I)})}catch(E){alert("getSPItems Error:"+E.description)}}function t(E){var I=[];var H;for(var F=0;F<E.length;F++){var G=E[F].attributes;I[F]={};for(i=0;i<G.length;i++){H=G[i].name.replace(/ows_/i,"").replace(/_x0020_/g,"");I[F][H]=G[i].value}}return I}function C(G){try{var F='<GetViewCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+G.ListName+"</listName></GetViewCollection>";m(G.SiteURL+"views.asmx","http://schemas.microsoft.com/sharepoint/soap/GetViewCollection",F,function(I){if(G.ViewName.length==0){G.ViewName=$(I).find("View[DefaultView='TRUE']").attr("DisplayName")}var H=$(I).find("View[DisplayName='"+G.ViewName+"']");if(H.attr("Name")!=null){var J=H.attr("Name");F="<GetView xmlns='http://schemas.microsoft.com/sharepoint/soap/'><listName>"+G.ListName+"</listName><viewName>"+J+"</viewName></GetView>";m(G.SiteURL+"views.asmx","http://schemas.microsoft.com/sharepoint/soap/GetView",F,function(M){var L=$(M).find("View").get(0).xml;if(L==null){L=new XMLSerializer().serializeToString($(M).find("View").get(0))}var K=L.indexOf("Query")-1;L=L.substr(K,L.length-K);L=L.replace("</View>","");G.CamlQuery=L;w(G,0)})}else{alert("'"+G.ViewName+"' view does not exist in '"+G.ListName+"' list.")}})}catch(E){alert("getSPItem Error:"+E.description)}}function B(G,F){G.xmlDoc=F;var E=$("row",F);if(E.get(0)==null){E=$("z\\:row",F)}G.JQueryData=E;if($("rs\\:data",F).length>0){G.total=$("rs\\:data",F)[0].attributes[0].value;if($("rs\\:data",F)[0].attributes.length>1){G.nextPage=$("rs\\:data",F)[0].attributes[1].value}}if(E.get(0)!=null){u(G,E)}}function u(K,I){var F=I.get(0).attributes;if(F.length>0){K.Fields=[]}b.Lists.ListName=K.ListName.toUpperCase();K.Items=t(I);var J=D(K.Items);var G="";$.each(J,function(N,L){K.Fields.push(L);G=L.replace(/ows_/i,"").replace(/_x0020_/g,"");var M=K.ListName.toUpperCase()+"."+G;if($.inArray(M,b.Lists.Items)==-1){b.Lists.Items.push(M)}});var E=K.Fields.length;b.Lists.FieldCount=E;K.FieldCount=E;var H=K.Items.length;b.Lists.ItemCount=H;K.ItemCount=H}function D(E){var F={};$.each(E,function(G,H){$.each(H,function(I,J){F[I]=I})});return F}});return this.Lists};b.fn.Form=b.prototype.Form=b.Form=function(x,v){this.Form.Items=new Array();this.Form.ItemNames=new Array();this.Form.FieldCount=0;this.Form.id=0;this.Form.AutoSaveInterval=0;this.Form.Schema=null;this.Form.readForm=(function(F,z){try{if(b.Form.Items.length>0){return b.Form}var G=null;var y=0;var D=[];var E,A="";b.valSiteURL(F);b.valListName(z);E=p.SiteURL;A=b.ListName;if(E==""||A==""){throw"A site URL [siteURL] and list name [schemaListName] is a required parameter when calling jPoint.Form.readForm on a page that does not have '/Lists' in the URL."}D=$("div.commentsNode");if(D.length<1){D=w()}b.Form.Items=new Array();b.Form.ItemNames=new Array();b.Form.FieldCount=0;for(var C=0;C<D.length;C++){if(D[C].innerHTML.indexOf(d)>0){G=new l(D[C]);y=b.Form.Items.length;G.ItemIndex=y;b.Form.Items[y]=G;b.Form[G.InternalName]=G;b.Form[G.Name]=G;b.Form[b.strip(G.Name)]=G;b.Form.ItemNames.push("Form."+b.strip(G.InternalName))}}b.Form.FieldCount=b.Form.Items.length}catch(B){alert("An error occurred when reading the form. "+B);return false}return b.Form});this.Form.saveForm=(function(){try{var M=b.SiteURL;var E=b.ListName;if(p.Form.ID==-1){p.Form.ID=0}else{if(location.href.indexOf("ID=")>-1&&p.Form.ID<1){var C=location.href.substr(location.href.indexOf("ID=")+3).indexOf("&");var F=0;if(C>-1){F=location.href.substr(location.href.indexOf("ID=")+3,C)}else{F=location.href.substr(location.href.indexOf("ID=")+3)}if(F>0){p.Form.ID=F}}}b.Form.readForm();if(b.Form.Items.length>0){var D=b.Lists.setSPObject(M,E);var z=null;var L={};L.id=p.Form.ID||"0";for(var J=0;J<b.Form.Items.length;J++){z=b.Form.Items[J];if(z.InternalName.length>0){switch(z.Type){case"SPFieldDateTime":var O=new Date(z.val());L[z.InternalName]=O.getFullYear()+"-"+(O.getMonth()+1)+"-"+O.getDate()+" "+O.getHours()+":"+O.getMinutes()+":"+O.getSeconds()+"Z";break;case"SPFieldUser":var I=z.val();$.loginfo("User field length:"+I.length);if(I.length>0){var N=$("Div[data]",I).attr("data");$.loginfo("Data attribute:"+N);var K="";var H="";if(N.indexOf("SPUserID")>-1){K=N.substr(N.indexOf("SPUserID")+43);K=K.substr(0,K.indexOf("<"));H=N.substr(N.indexOf("DisplayName")+46);H=H.substr(0,H.indexOf("<"))}else{H=N.substr(N.indexOf("Email")+40);H=H.substr(0,H.indexOf("<"));H=H.substr(0,H.indexOf("@"));D.getUserProfile(H);K=D.User.ID}L[z.InternalName]=K+";#"+H}else{L[z.InternalName]=I}break;default:L[z.InternalName]=z.val();break}}}var B=new Array;B.push(L);b.Form.ID=D.addItem(B).ID;var A=$('input[type="button"][value="OK"]');if(A.length>0){$(A).each(function(){var P="var myJPObj=new jPoint(); jPoint.Form.ID = "+b.Form.ID+";myJPObj.Form.saveForm();";this.onclick=new Function(P)})}var y=$('input[type="button"][value="Cancel"]');if(y.length==0){y=$('input[type="button"][value="Save and Close"]')}if(y.length>0){$(y).each(function(){var P="var myJPObj=new jPoint(); jPoint.Form.ID = "+b.Form.ID+';myJPObj.Form.saveForm();location.href=location.href.substr(location.href.indexOf("Source=") + 7) + "?Source=" + location.href.substr(location.href.indexOf("Source=") + 7)';this.onclick=new Function(P)})}}else{alert("saveForm only works on the New/Edit form page.")}}catch(G){alert("saveForm Error:"+G.description)}return b.Form});this.Form.field=(function(C){var A=e;try{b.Form.readForm();var B=$(C).closest("TR .jPointRow");if(B.length>0){var z=B.attr("id");A=b.Form[z]}}catch(y){alert("An error occurred in Form.field(). "+y)}return A});b.fn.Webparts=b.prototype.Webparts=b.Webparts=function(){this.Webparts.getPageWebPartProperties=(function(C,z){var A=new Object();A.SiteURL=L_Menu_BaseUrl+"/_vti_bin/";A.PageURL=C;if(A.PageURL.indexOf(".aspx")>-1){A.PageURL=A.PageURL.substr(0,A.PageURL.indexOf(".aspx")+5)}var D="";var B="";m(A.SiteURL+"WebPartPages.asmx","http://microsoft.com/sharepoint/webpartpages/GetWebPartProperties2",'<GetWebPartProperties2 xmlns="http://microsoft.com/sharepoint/webpartpages"><pageUrl>'+A.PageURL+"</pageUrl><storage>Shared</storage><behavior>Version3</behavior></GetWebPartProperties2>",function(E){$.each($(E).find("WebPart"),function(F,H){var G=H.text||H.textContent;if(G.indexOf(z.replace(/-/g,"_"))>-1){D=$(H.xml).attr("ID")||$(H).attr("ID");if(H.xml){B=H.xml.replace(/</g,"&lt;").replace(/>/g,"&gt;")}else{B=(new XMLSerializer()).serializeToString(H).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\\n/g,"\\n")}return false}})});var y='&lt;?xml version="1.0" encoding="utf-16"?&gt;'+B;A.WebpartID=D;A.WebpartXMLStr=y;return A});this.Webparts.save=this.Webparts.Save=(function(A,z){var y=A.WebpartXMLStr.substr(0,A.WebpartXMLStr.indexOf("[CDATA[")+7)+z.replace(/</g,"&lt;").replace(/>/g,"&gt;")+A.WebpartXMLStr.substr(A.WebpartXMLStr.indexOf("]]"),A.WebpartXMLStr.length);m(A.SiteURL+"WebPartPages.asmx","http://microsoft.com/sharepoint/webpartpages/SaveWebPart",'<SaveWebPart xmlns="http://microsoft.com/sharepoint/webpartpages"><pageUrl>'+A.PageURL+"</pageUrl><storageKey>"+A.WebpartID+"</storageKey><webPartXml>"+y+"</webPartXml><storage>Shared</storage></SaveWebPart>",function(B){})});this.Webparts.updatejPartProperties=(function(D,B){var C=D.WebpartXMLStr.indexOf("var myjLocalOptions");var A="";if(C>-1){C+=19;var y=D.WebpartXMLStr.substring(C,D.WebpartXMLStr.length).indexOf(";&lt;/script&gt;")+C;A=D.WebpartXMLStr.substr(0,C)+"="+B.replace(/</g,"&lt;").replace(/>/g,"&gt;")+D.WebpartXMLStr.substr(y,D.WebpartXMLStr.length)}else{var z=D.WebpartXMLStr.indexOf("[CDATA[")+7;A=D.WebpartXMLStr.substr(0,z)+"&lt;script&gt;var myjLocalOptions="+B.replace(/</g,"&lt;").replace(/>/g,"&gt;")+";&lt;/script&gt;"+D.WebpartXMLStr.substr(z,D.WebpartXMLStr.length)}m(D.SiteURL+"WebPartPages.asmx","http://microsoft.com/sharepoint/webpartpages/SaveWebPart",'<SaveWebPart xmlns="http://microsoft.com/sharepoint/webpartpages"><pageUrl>'+D.PageURL+"</pageUrl><storageKey>"+D.WebpartID+"</storageKey><webPartXml>"+A+"</webPartXml><storage>Shared</storage></SaveWebPart>",function(E){location.reload(true)})});return this.Webparts};var t=function(z){var y=z;if(e!=b.Form.Schema){$.each(b.Form.Schema,function(A,B){if(b.sameNames(B.FieldName,z)){y=B.FieldInternalName;return false}})}else{throw"Form schema is not defined.  Check siteURL and schemaListName parameters to Form.readForm() call."}return y};var w=function(){try{var z,E,G,C;var B,y,I,A,H,F=null;var J;B=$("input[id$='_TextField']").closest("table").addClass("jPointTable");if(B.length==0){B=$("H3").closest("table").addClass("jPointTable")}y=B.children().children("[id!='idAttachmentsRow']").addClass("jPointRow").attr("id",function(K){if($(this).find("td").length>0){return b.strip($($(this).find("td").get(0).childNodes[0]).text())}else{return K}});p.Lists.setSPObject(b.SiteURL,b.ListName);b.Form.Schema=b.Lists[b.ListName.toUpperCase()].getSPListFields().Schema;F=$("tr.jPointRow > td:nth-child(2)").each(function(L){z={};I=$(this).parent().attr("id");z[a]=I;J=/ctl\d{2}_.*_ctl\d{2}_([A-Z][a-zA-Z]+)/;try{A=J.exec($(this).find("*[id^='ctl']").get(0).id)[1]}catch(K){A="SPFieldChoice"}z[d]=I;z[q]=A;G=a+'="'+z.FieldName+'" '+d+'="'+t(z.FieldInternalName)+'" '+q+'="'+z.FieldType+'" ';if($(this).find("span").length<1&&$(this).find("#idAttachmentsTable").length<1){$(this).html("<span>"+$(this).html()+"</span>")}if($(this).find(".commentsNode").length<1){$(this).prepend("<div class='commentsNode' style='display: none'>"+G+"</div>").addClass("jPointField")}}).find("div.commentsNode");$("tr.jPointRow > td:nth-child(1)").each(function(K){})}catch(D){alert("getAlternativeComments Error: "+D.message)}return F};var u=function(z,C){var y=$(z).contents().filter(function(){var F=(this==C);return F});if(y.length<=0){var A=$(z).children();if(A.length>0){for(var B=0;B<A.length;B++){var E=A[B];var D=u(E,C);if(D.length>0){y=D;break}}}}return y};return this.Form};b.fn.WebServices=b.prototype.WebServices=b.WebServices=function(){this.Result={};this.WebServices.GetWeb=(function(z){var x=t(z);var y={siteUrl:x.siteUrl,serviceName:"Webs",operationPath:e,operationName:"GetWeb",soapBody:"<webUrl>"+x.siteUrl+"</webUrl>",returnNode:"Web",filterNode:x.filterNode,filterAttr:x.filterAttr};var w=this.CallSPWebSvc(y);return w});this.WebServices.GetWebCollection=(function(z){var x=t(z);var y={siteUrl:x.siteUrl,serviceName:"Webs",operationPath:e,operationName:"GetWebCollection",soapBody:"",returnNode:"Web",filterNode:x.filterNode,filterAttr:x.filterAttr};var w=this.CallSPWebSvc(y);return w});this.WebServices.WebUrlFromPageUrl=(function(z){var x=t(z);var y={siteUrl:x.siteUrl,serviceName:"Webs",operationPath:e,operationName:"WebUrlFromPageUrl",soapBody:"<pageUrl>"+x.webUrl+"</pageUrl>",returnNode:"WebUrlFromPageUrlResult"};var w=this.CallSPWebSvc(y);return w});this.WebServices.GetAllSubWebCollection=(function(z){var x=t(z);var y={siteUrl:x.siteUrl,serviceName:"Webs",operationPath:e,operationName:"GetAllSubWebCollection",soapBody:"",returnNode:"Web",filterNode:x.filterNode,filterAttr:x.filterAttr};var w=this.CallSPWebSvc(y);return w});this.WebServices.GetListCollection=(function(z){var x=t(z);var y={siteUrl:x.siteUrl,serviceName:"Lists",operationPath:e,operationName:"GetListCollection",soapBody:"",returnNode:"List",filterNode:x.filterNode,filterAttr:x.filterAttr};var w=this.CallSPWebSvc(y);return w});this.WebServices.GetList=(function(z){var x=t(z);var y={siteUrl:x.siteUrl,serviceName:"Lists",operationPath:e,operationName:"GetList",soapBody:"<listName>"+x.listName+"</listName>",returnNode:"List",filterNode:x.filterNode,filterAttr:x.filterAttr};var w=this.CallSPWebSvc(y);return w});this.WebServices.GetUserLoginFromEmail=(function(B){var x=t(B);var C=x.userEmails.split(",");var z="<emailXml><Users>";for(var y=0;y<C.length;y++){z+="<User Email='"+C[y]+"'/>"}z+="</Users></emailXml>";var A={siteUrl:x.siteUrl,serviceName:"UserGroup",operationPath:"directory",operationName:"GetUserLoginFromEmail",soapBody:z,returnNode:"User",filterNode:x.filterNode,filterAttr:x.filterAttr};var w=this.CallSPWebSvc(A);return w});this.WebServices.GetUserInfo=(function(z){var x=t(z);var y={siteUrl:x.siteUrl,serviceName:"UserGroup",operationPath:"directory",operationName:"GetUserInfo",soapBody:"<userLoginName>"+x.userLoginName+"</userLoginName>",returnNode:"User",filterNode:x.filterNode,filterAttr:x.filterAttr};var w=this.CallSPWebSvc(y);return w});this.WebServices.GetRoleCollection=(function(C){var x=t(C);var z=x.roleNames.split(",");var A="<roleNameXml><Roles>";for(var y=0;y<z.length;y++){A+="<Role RoleName='"+z[y]+"'/>"}A+="</Roles></roleNameXml>";var B={siteUrl:x.siteUrl,serviceName:"UserGroup",operationPath:"directory",operationName:"GetRoleCollection",soapBody:A,returnNode:"Roles",filterNode:x.filterNode,filterAttr:x.filterAttr};var w=this.CallSPWebSvc(B);return w});this.WebServices.GetRoleInfo=(function(z){var x=t(z);var y={siteUrl:x.siteUrl,serviceName:"UserGroup",operationPath:"directory",operationName:"GetRoleInfo",soapBody:"<roleName>"+x.roleName+"</roleName>",returnNode:"Role",filterNode:x.filterNode,filterAttr:x.filterAttr};var w=this.CallSPWebSvc(y);return w});this.WebServices.GetGroupCollectionFromWeb=(function(z){var x=t(z);var y={siteUrl:x.siteUrl,serviceName:"UserGroup",operationPath:"directory",operationName:"GetGroupCollectionFromWeb",soapBody:"",returnNode:"Groups",filterNode:x.filterNode,filterAttr:x.filterAttr};var w=this.CallSPWebSvc(y);return w});this.WebServices.GetGroupCollectionFromSite=(function(z){var x=t(z);var y={siteUrl:x.siteUrl,serviceName:"UserGroup",operationPath:"directory",operationName:"GetGroupCollectionFromSite",soapBody:"",returnNode:"Groups",filterNode:x.filterNode,filterAttr:x.filterAttr};var w=this.CallSPWebSvc(y);return w});this.WebServices.GetRoleCollectionFromWeb=(function(z){var x=t(z);var y={siteUrl:x.siteUrl,serviceName:"UserGroup",operationPath:"directory",operationName:"GetRoleCollectionFromWeb",soapBody:"",returnNode:"GetRoleCollectionFromWebResult",filterNode:x.filterNode,filterAttr:x.filterAttr};var w=this.CallSPWebSvc(y);return w});this.WebServices.CallSPWebSvc=(function(z){var K=t(z);var y=K.siteUrl;var w=K.serviceName;var E=K.operationName;var A=K.soapBody;var B=K.returnNode;var F=K.operationPath;var D=K.filterNode;var I=K.filterAttr;this.Result={};var C;var J={siteurl:y,service:w,operation:E,resultnode:B,success:false,errorCode:"",errorText:"jP.WebServices.CallSPWebSvc internal error",responseText:"",count:-1,data:{},xmlDoc:{}};var G="<"+E+' xmlns="http://schemas.microsoft.com/sharepoint/soap/';if(typeof F!="undefined"){G+=F+"/"}if(A!=""){G+='">'+A+"</"+E+">"}else{G+='" />'}var H="http://schemas.microsoft.com/sharepoint/soap/";if(typeof F!="undefined"){H+=F+"/"}H+=E;g(y+"/_vti_bin/"+w+".asmx",H,G,function(N){C=$(N);if(typeof N.status!="undefined"){J.success=false;J.count=-1;if(typeof N.statusText!="undefined"){J.errorCode=N.status;J.errorText=N.statusText;J.responseText=N.responseText}else{var L=$("errorcode",N.responseXML);var M=$("errorstring",N.responseXML);if(L.length>0){J.errorCode=L.text()}if(M.length>0){J.errorText=M.text()}J.xmlDoc=N.responseXML}}else{J.success=true;J.errorCode="0x00000000";J.errorText=null;J.xmlDoc=N;J.count=$(B,N).length;$.each($(B,N),function(O,P){if(P.nodeName!="#text"&&P.nodeName!="#cdata-section"){J.data[P.nodeName+O]=v(P)}})}});this.Result=J;var x=u(C,D,I);if(typeof x!="undefined"){C=x}if(typeof D!="undefined"&&typeof x=="undefined"){C=e}return C});var v=function(x){var A={};var C=0;try{if(x.nodeName=="#text"||x.nodeName=="#cdata-section"){return e}A.NodeName=x.nodeName;var w={};if(x.attributes!=null){$.each(x.attributes,function(D,E){w[E.name]=E.value})}A.NodeAttr=w;if($.browser.msie||$.browser.chrome){C=0;var z=x.firstChild;while(z!=null){var B=v(z);if(typeof B!="undefined"){A[B.NodeName+C]=B;C++}z=z.nextSibling}A.NodeText=$.browser.chrome?x.textContent:x.text;A.ChildrenCount=C}else{$.each(x.children,function(F,D){var E=v(D);A[E.NodeName+F]=E});A.NodeText=x.textContent;A.ChildrenCount=$(x.children).length}}catch(y){alert("WebServices.xml2Obj Error: "+y.description+"("+x.nodeName+C+")")}return A};var u=function(w,z,x){var y;if(typeof z!="underfined"&&typeof x!="undefined"){y=$(w).find(z).Attrs(x);if(y.length==0){y=e}}return y};var t=function(y){var x={siteUrl:document.location.protocol+"//"+document.location.host+jP.SiteURL,webUrl:document.location};var w=$.extend(x,y);return w}};jQuery.fn.Attrs=function(u){var t=[];this.each(function(){t.push($(this).attr(u))});return t};var s=navigator.userAgent.toLowerCase();jQuery.browser={version:(s.match(/.+(?:rv|it|ra|ie|me)[\/: ]([\d.]+)/)||[])[1],chrome:/chrome/.test(s),safari:/webkit/.test(s)&&!/chrome/.test(s),opera:/opera/.test(s),msie:/msie/.test(s)&&!/opera/.test(s),mozilla:/mozilla/.test(s)&&!/(compatible|webkit)/.test(s)};b.extend=b.fn.extend=jQuery.extend;b.extend({Form:b.Form(),Lists:b.Lists(),ListName:b.valListName(),SiteURL:b.valSiteURL(),Webparts:b.Webparts(),WebServices:b.WebServices(),includePath:"",include:function(y){var t=typeof y=="string"?[y]:y;for(var w=0;w<t.length;w++){var u=t[w].replace(/^\s|\s$/g,"");var z=u.split(".");var v=z[z.length-1].toLowerCase();var B=v=="css";var C=B?"link":"script";var x=B?" type='text/css' rel='stylesheet' ":" language='javascript' type='text/javascript' ";var A=(B?"href":"src")+"='"+b.includePath+u+"'";if($(C+"["+A+"]").length==0){document.write("<"+C+x+A+"></"+C+">")}}}});b.prototype.init();function m(t,w,y,x){try{var v=new Array();v.push("<?xml version='1.0' encoding='utf-8'?>");v.push("<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'>");v.push("<soap:Body>");v.push(y);v.push("</soap:Body>");v.push("</soap:Envelope>");$.ajax({async:false,type:"POST",url:t,contentType:"text/xml; charset=utf-8",processData:false,data:v.join(""),dataType:"xml",beforeSend:function(z){z.setRequestHeader("X-Vermeer-Content-Type","text/xml; charset=utf-8");z.setRequestHeader("SOAPAction",w)},success:x,error:function(z,B,A){}})}catch(u){}}function g(t,w,y,x){try{var v=new Array();v.push("<?xml version='1.0' encoding='utf-8'?>");v.push("<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'>");v.push("<soap:Body>");v.push(y);v.push("</soap:Body>");v.push("</soap:Envelope>");$.ajax({async:false,type:"POST",url:t,contentType:"text/xml; charset=utf-8",processData:false,data:v.join(""),dataType:"xml",beforeSend:function(z){z.setRequestHeader("X-Vermeer-Content-Type","text/xml; charset=utf-8");z.setRequestHeader("SOAPAction",w)},success:x,error:x})}catch(u){}}function r(v,y,u,z,x){var t=new Array();try{t.push('<GetListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">');t.push("<listName>"+v+"</listName>");if(y.toLowerCase().indexOf("<query")>=0){y=y.replace("<Query>",'<query><Query xmlns="">');y=y.replace("</Query>","</Query></query>");y=y.replace("<ViewFields>",'<viewFields><ViewFields xmlns="">');y=y.replace("</ViewFields>","</ViewFields></viewFields>");y=y.replace("<QueryOptions>",'<queryOptions><QueryOptions xmlns="">');y=y.replace("</QueryOptions>","</QueryOptions></queryOptions>");y=y.replace("<RowLimit","<rowLimit");y=y.replace("</RowLimit>","</rowLimit>");t.push(y)}else{if(y!=null&&y!=""){t.push('<query><Query xmlns="">');t.push(y);t.push("</Query></query>")}if(u!=null&&u.length>-1){t.push('<viewFields><ViewFields xmlns="">');$.each(u,function(B,C){t.push('<FieldRef Name="'+C.internalName+'"/>')});t.push("</ViewFields></viewFields>")}if(z!=e&&z!=null&&z>0){t.push("<rowLimit>"+z+"</rowLimit>")}else{t.push("<rowLimit>100000</rowLimit>")}t.push('<queryOptions><QueryOptions xmlns=""><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns>');if(x!=e&&x!=null&&x!=""){t.push('<Paging ListItemCollectionPositionNext="'+x.replace(/&/g,"&amp;")+'" />')}t.push("</QueryOptions></queryOptions>")}t.push("</GetListItems>")}catch(w){alert("buildQueryContent Error:"+w.description)}var A=t.join("");return A}function c(u,x){var t=new Array();try{t.push('<UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">');t.push("<listName>"+u+"</listName>");t.push('<updates><Batch OnError="Continue" xmlns="">');for(var v=0;v<x.length;v++){var A=0;if(x[v].id!=null){A=x[v].id}if(x[v].ID!=null){A=x[v].ID}if(A<1){t.push('<Method ID="1" Cmd="New">')}else{t.push('<Method ID="1" Cmd="Update">');t.push('<Field Name="ID">'+A+"</Field>")}var z=x[v];$.each(z,function(C,B){if(C.toLowerCase()!="id"){t.push('<Field Name="');t.push(C);t.push('"><![CDATA[');t.push(B);t.push("]]></Field>")}});t.push("</Method>")}t.push("</Batch></updates></UpdateListItems>")}catch(w){alert("buildModifyContent Error:"+w.description)}var y=t.join("");return y}function k(u,x){var t=new Array();try{t.push('<UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">');t.push("<listName>"+u+"</listName>");t.push('<updates><Batch OnError="Continue" xmlns="">');t.push('<Method ID="1" Cmd="Delete">');t.push('<Field Name="ID">'+x+"</Field>");t.push("</Method>");t.push("</Batch></updates></UpdateListItems>")}catch(v){}var w=t.join("");return w}function l(I,L,E){try{var t="FieldInternalName";var x="FieldName";var z="FieldType";var B="Specify your own value";var A=L;var F=E;this.FieldInternalName=t;this.FieldName=x;this.FieldType=z;this.SpecifyOtherField=B;this.Item=$(I.parentNode).find("span").get(0);this.ItemRow=I.parentNode.parentNode;this.ItemIndex=e;var C=new RegExp('"');var K=I.innerHTML.split(C);var J=null;for(var H=0;H<K.length;H++){J=K[H].split("=");if(J.length>0){if(J[0].indexOf(t)>=0){this.InternalName=K[H+1]}else{if(J[0].indexOf(x)>=0){this.Name=K[H+1]}else{if(J[0].indexOf(z)>=0){this.Type=K[H+1]}}}}}function G(){this.ItemRow.style.display="none";return this}function u(){this.ItemRow.style.display="";return this}function y(R){var N,O,P;try{if(R!==e&&R!="oldValHint"){O=new String('var jOV = new jPoint(); jOV.Form.readForm("'+A+'","'+E+'").'+this.Name+".val(jOV.Form."+this.Name+".oldVal()); $(this).parent().hide(); jOV = null;");N="<a class='oldValCopyLink' onclick='"+O+"' title='Swap previous value'><img style='border: 0px; margin-right: 4px; position: relative; top: 2px' src='/_layouts/images/recyclebinrestore.gif' title='Copy this into field'/></a><span class='oldValDiv'>"+R+"</span>";$(this.Item).data("oldVal",R).data("oldValHint",N).addClass("oldVal").parent().addClass("oldValCell");P=this}else{P=(R=="oldValHint")?$(this.Item).data("oldValHint"):$(this.Item).data("oldVal");if(!P){P=""}}}catch(Q){}return P}function M(R,S){var O=S||true;if(S===false){O=false}var P,N;try{if(R!==e){N=doVal(e,this);if(O&&N!=R&&N!=e){this.oldVal(N)}P=doVal(R,this)}else{P=doVal(e,this)}}catch(Q){}return P}doVal=function(Q,R){var N=null;var P;try{if($(".jPointField",R.ItemRow).find(".datefield").length==0){P=$(".jPointField",R.ItemRow).find(":input:visible").addClass("jPointFieldInput")}else{P=$(".jPointField",R.ItemRow).find(":input:first").addClass("jPointFieldInput")}if(P.length<1){P=$(".jPointField",R.ItemRow).find(":input").addClass("jPointFieldInput")}if($(R.Item).find(".ms-rtelong").contents().find("body").html()!=null){if(Q!==e){$(R.Item).find("textarea:eq(0)").text(Q);$(R.Item).find(".ms-rtelong").contents().find("body").html("<div>"+Q+"</div>")}else{if($(R.Item).find(".ms-rtelong").contents().find("body").html()!=null){N=$(R.Item).find(".ms-rtelong").contents().find("body").html()}else{N=$(R.Item).find("textarea:eq(0)").text();if(N.length==0){N=$(R.Item).find("textarea:eq(0)").get(0).innerHTML}}}}else{if(R.Type=="HiddenUserFieldValue"){if(Q!==e){$(R.ItemRow).find(".ms-inputuserfield").html(Q);$(document).ready(function(){$($(R.ItemRow).find("a[title=Check Names]").get(0)).click()})}else{N=$(R.ItemRow).find("textarea").attr("value");if(N.length==0){N=$(R.ItemRow).find(".ms-inputuserfield").html()}}}else{if(P.length==1&&$(P[0]).attr("type")!="checkbox"){if(Q!==e){if(P[0].nodeName!="TEXTAREA"){$(P[0]).val(Q);$(P[0]).change()}else{if(R.Type=="Lookup"&&Q==""){P[0].value=0}else{P[0].value=Q}}}else{if(R.Type=="Lookup"){N=[];N.push($(P).find(":selected").val());N.push($(P).find(":selected").text());N=N.join(";#")}else{N=$(P[0]).val()}}}else{if(P.length==2&&R.Type=="UrlControlId"){if(Q!==e){if(Q==""){Q=["",""]}$(P[0]).val(Q[0]);$(P[1]).val(Q[1])}else{N=[$(P[0]).val(),$(P[1]).val()]}}else{if(P.length>=1&&R.Type=="DateTimeField"){if(Q!==e){handleDate(P,Q)}else{N=handleDate(P)}}else{if($(P[0]).attr("type")=="checkbox"){if(Q!==e){if(Q==""||Q=="No"||Q=="0"){Q=false}if(Q=="Yes"||Q=="1"){Q=true}handleCheckbox(P,Q)}else{N=handleCheckbox(P)}}else{if($(P[0]).attr("type")=="radio"){if(Q!==e){handleRadio(P,Q)}else{N=handleRadio(P)}}else{if(R.Type=="MultiLookupPicker"){if(Q!==e){if(Q==""){Q=false}handleMultLookup(P,Q)}else{N=handleMultLookup(P)}}else{if(Q!==e){P[0].value=Q}else{if(P.length<1){N=handleNonInput(R)}else{N=$(P[0]).val()}}}}}}}}}}}catch(O){alert("Val() Error: "+O.message)}if(Q){N=R}return N};handleNonInput=function(O){var N=$(O.Item).html();N=N.replace(/[\n\r\t\xA0]/g,"");N=N.replace(/<!--.*-->/,"");N=N.replace("&nbsp;","");N=$.trim(N);return N};handleDate=function(X,aa){var W;var Y=false;try{var R=$(X[0]).val()+" ";$(X).each(function(ac){if(ac>0){R+=$(this).val()}});var P=/^([\d]{1,2})\/([\d]{1,2})\/([\d]{4}) $/;var O=/^([\d]{1,2})\/([\d]{1,2})\/([\d]{4}) ([\d]{1,2}) ([AP]M)([\d]{1,2})$/;var S=R.match(O);if(S){h=S[4];if(S[5]=="AM"&&h=="12"){h="00"}else{if(S[5]=="PM"&&h!="12"){h=parseInt(h)+12}}W=S[3]+"-"+S[1]+"-"+S[2]+"T"+h+":"+S[6]+":00Z"}else{var S=R.match(P);if(S){W=S[3]+"-"+S[1]+"-"+S[2]}else{}}}catch(U){alert("handleDate Error:"+U.description)}if(aa!==e){if(typeof aa=="object"){var T=(aa.getMonth()+1)+"/"+aa.getDate()+"/"+aa.getFullYear();var Z=aa.getHours();if(Z==0){ab="12 AM"}else{if(Z==12){ab="12 PM"}else{if(Z>=13){ab=(Z-12)+" PM"}else{ab=Z+" AM"}}}var Q=aa.getMinutes();Q=Q-(Q%5);var V=Q+"";$(X[0]).val(T);if($(X).length>1){$(X[1]).val(ab);$(X[2]).val(V)}}else{if(typeof aa=="string"){var P=/^([\d]{1,2})\/([\d]{1,2})\/([\d]{4})$/;var O=/^([\d]{4})-([\d]{1,2})-([\d]{1,2})T([\d]{1,2}):([\d]{1,2}):([\d]{1,2})Z$/;var N=/^([\d]{4})-([\d]{1,2})-([\d]{1,2})$/;var T="";var ab="";var V="";var S=aa.match(P);if(S){T=aa}else{var S=aa.match(O);if(S){T=S[2]+"/"+S[3]+"/"+S[1];var Z=parseInt(S[4]);if(Z==0){ab="12 AM"}else{if(Z==12){ab="12 PM"}else{if(Z>=13){ab=(Z-12)+" PM"}else{ab=Z+" AM"}}}var Q=parseInt(S[5]);Q=Q-(Q%5);V=Q+""}else{var S=aa.match(N);if(S){T=S[2]+"/"+S[3]+"/"+S[1]}}}$(X[0]).val(T);if($(X).length>1){$(X[1]).val(ab);$(X[2]).val(V)}}else{alert("handleDate Error: Invalid date/time value")}}W=Y}return W};handleMultLookup=function(V,W){var T=false;var Z,Q,S,P=null;var X=[];try{Z=$(V).closest(".jPointField").find("span");if(W!=e){Q=Z.find("SELECT")[0];S=Z.find("SELECT")[1];P="";X=[];if(W===false){Q=S;S=Z.find("SELECT")[0]}else{if(W===true){W=false}else{if(W.constructor!=Array){W=[W,""];P=W.join(":")}else{P=W.join(":")}}}for(H=Q.length-1;H>=0;H--){if(W===false||P.indexOf(Q[H].text)>=0){var U=new Option(Q[H].text,Q[H].value);var Y=S.options[(S.length>0)?S.length-1:0];try{S.add(U,Y)}catch(R){S.add(U,(S.length>0)?S.length-1:0)}X.push(H);T=true}}var N=X.length;for(C=0;C<N;C++){Q.remove(X[C])}}else{S=Z.find("SELECT")[1];T=[];for(j=0;j<S.length;j++){T.push($(S[j]).val());T.push($(S[j]).text())}T=T.join(";#")}}catch(O){}return T};handleCheckbox=function(Q,T){var P=[];var R=false;var U,S=null;var V=[];var N=false;try{if(T===e||T.constructor==Array){U=T}else{if(T===true||T===false){U=[T]}else{if(T.indexOf(",")>0){U=T.replace(/,/g,",true,")+",true";U=U.split(",")}else{if(T.length>0){U=T+",true";U=U.split(",")}else{throw"value parameter is invalid: "+T+".  value needs to be an Array of value pairs, comma delimited string, true, or false"}}}}if(U){for(H=0;H<U.length;H=H+2){N=false;Q.each(function(X){var W,Y;S=$(this).parent().attr("title");if(S==""){S=T}if(T===true||T===false){W=S;Y=T}else{W=U[H];Y=U[H+1]}if(b.sameNames(S,W)){$(this).attr("checked",Y);if($(this).attr("title").indexOf(B)>-1&&T===false){$(Q).eq(Q.length-1).val("")}R=true;N=true}});if(!N){V.push(U[H])}}if(V.length>0&&($(Q).eq(Q.length-2).parent().attr("title").indexOf(B)>-1)){$(Q).eq(Q.length-2).attr("checked",true);$(Q).eq(Q.length-1).val(V.join(","));R=true}}else{Q.each(function(W){S=$(this).parent().attr("title");if(S==""&&W==0){P=($(this).attr("checked")==true)?"1":"0"}else{if($(this).attr("checked")==true){if(S.indexOf(B)>-1){P.push($(Q[W+1]).val())}else{P.push(S)}}}})}}catch(O){}if(T!==e){P=R}else{if(P.length<1){P=false}}return P};handleRadio=function(Q,R){var N;var P=false;var S=false;try{if($("*:selected",Q).length>0){S=true}Q.each(function(U){var T,V;label=$(this).parent().attr("title");if(R!==e){if(S){if($(this).find("option").length>0){$(Q[U-1]).attr("checked",true);$(this).find("option").each(function(W){if(R==""&&W==0){$(this).attr("selected",true);P=true;$(Q).eq(Q.length-1).val(R);return false}if(b.sameNames($(this).val(),R)){$(this).attr("selected",true);P=true;return false}});if(P==true){return false}}}else{if(R==""&&U==0){$(this).attr("checked",true);$(Q).eq(Q.length-1).val("");P=true;return false}if(b.sameNames(label,R)){$(this).attr("checked",true);P=true;return false}}}else{if($(this).attr("checked")===true){if(S||(label&&label.indexOf(B)>-1)){V=$(Q[U+1]).val();N=V}else{N=label}}}});if(R!==e&&!P&&($(Q).eq(Q.length-2).parent().attr("title").indexOf(B)>-1)){$(Q).eq(Q.length-2).attr("checked",true);$(Q).eq(Q.length-1).val(R);P=true}}catch(O){}if(R!==e){N=P}return N};function D(P){var N=e;var O=$(this.ItemRow);switch(P.toString().toLowerCase()){case":itemrow":N=O;break;case":itemlabel":N=O.children(":first-child");break;case":itemdata":N=O.children(":nth-child(2)");break;case":iteminputs":P=P.replace(":iteminputs","");N=O.find(":nth-child(2)").find("input,textarea,select "+P);break;default:N=O.find(P)}return N}function v(P){if(typeof P!="undefined"){var N=this.find(":iteminputs"+P)}else{var N=this.find(":iteminputs")}var O=[];$.each(N,function(S,Q){var R=Q.id;R=R.substr(R.lastIndexOf("_ctl00_")+7);O.push(R)});N.inputids=O;return N}this.hide=G;this.show=u;this.oldVal=y;this.val=M;this.find=D;this.inputs=v}catch(w){}}b.valSiteURL();b.valListName()})();(function(a){a.config=function(b){var d=a.extend({},a.config.defaults,b);try{myjPart.Options=d;if((myjPart.ShowConfigDefaults!=null&&myjPart.Options.Local==null)||$("span:contains('Add a Web Part')").length>0){var f="myjPart"+myjPart.Position;var e=$("#"+f);e.append("<div id='"+f+"info' style='display:block'></div>");e.append("<div id='"+f+"config' style='display:none'></div>");$("#"+f+"info").append("<table id='"+f+"infoTable' style='width:100%;height:100%;background-color:yellow'></table>");var c=$("#"+f+"infoTable");$.each(d.Plugin,function(l,m){c.append("<tr><td style='width:40%'>"+l+":</td><td style='width:60%'>"+m+"</td></tr>")});if(myjPart.ShowConfigDefaults!=null){c.append("<tr><td colspan='2' align='right'><input type='button' value='Options' onclick='editConfiguration(true, "+f+")'; /></td></tr>")}$("#"+f+"config").append("<table id='"+f+"configTable' style='width:100%;height:100%;background-color:silver'></table>");var k=$("#"+f+"configTable");k.append("<tr><td colspan='2' align='right'><input type='button' value='Update' onclick=updateConfiguration('"+f+"'); /><input type='button' value='Cancel' onclick='editConfiguration(false, "+f+")'; /></td></tr>");myjPart.WebpartDiv=e;myjPart.InfoDiv=$("#"+f+"info");myjPart.ConfigDiv=$("#"+f+"config");myjPart.ConfigTableDiv=k}if(myjPart.Options.Plugin.Name!=null){myjParts[myjPart.Options.Plugin.Name]=myjPart}myjPart.MainDiv=$("#"+myjPart.MainDivID)}catch(g){}};editConfiguration=function(b,c){if(b){$("#"+c.id+"info").hide();myjParts[parseInt(c.id.replace("myjPart",""))].showConfig();$("#"+c.id+"config").show()}else{$("#"+c.id+"info").show();$("#"+c.id+"config").hide()}};updateConfiguration=function(d){var c=myjParts[parseInt(d.replace("myjPart",""))];c.readConfig();if(c.Options.Local!=null){var e=a.Webparts.getPageWebPartProperties(location.href,$($("#"+d)[0].parentNode).attr("WebpartID"));var b="{";$.each(c.Options.Local,function(f,g){if(b.length>1){b+=","}if(typeof g=="string"){b+=f+":'"+g+"'"}else{b+=f+":"+g}});b+="}";a.Webparts.updatejPartProperties(e,b)}else{alert("Webpart's Local options are not defined")}}})(jPoint);